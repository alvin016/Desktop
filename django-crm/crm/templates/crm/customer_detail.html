{% extends "base.html" %}
{% block title %}å®¢æˆ¶è©³æƒ…{% endblock %}
{% block content %}
<h2 class="mb-4">ğŸ‘¤ å®¢æˆ¶è©³æƒ…</h2>
<div class="card shadow-sm p-4">
  <div class="row">
    <div class="col-md-3 text-center mb-3">
      {% if customer.photo %}
      <img src="{{ customer.photo.url }}" class="img-thumbnail img-fluid" style="max-height: 200px; cursor: pointer;"
          data-bs-toggle="modal" data-bs-target="#photoModal">
    {% else %}
    <div class="text-muted">ç„¡ç…§ç‰‡</div>
    {% endif %}
    </div>
    <div class="col-md-9">
      <h4>{{ customer.name }}</h4>
      <p><strong>Emailï¼š</strong> {{ customer.email }}</p>
      <p><strong>é›»è©±ï¼š</strong> {{ customer.phone }}</p>
      <p><strong>ç”Ÿæ—¥ï¼š</strong> {{ customer.birthday_md }}</p>
      <p><strong>æ˜Ÿåº§ï¼š</strong> {{ customer.get_constellation_display }}</p>
      <p><strong>æ€§åˆ¥ï¼š</strong>
        {% if customer.gender == 'M' %}ç”·{% elif customer.gender == 'F' %}å¥³{% else %}å…¶ä»–{% endif %}
      </p>
      <p><strong>åœ°å€ï¼š</strong> {{ customer.city }} {{ customer.district }}</p>
      <p><strong>å‚™è¨»ï¼š</strong><br>{{ customer.note|linebreaks }}</p>
    </div>
  </div>

  <div class="row mt-4">
    <div class="col d-grid gap-2 d-md-flex justify-content-md-end">
      <a href="{% url 'customer_edit' customer.id %}" class="btn btn-warning">âœï¸ ç·¨è¼¯</a>
      <a href="{% url 'customer_list' %}" class="btn btn-secondary">â†© è¿”å›</a>
    </div>
  </div>
</div>
<div class="modal fade" id="photoModal" tabindex="-1" aria-labelledby="photoModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="photoModalLabel">æŸ¥çœ‹ç…§ç‰‡</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="é—œé–‰"></button>
      </div>
      <div class="modal-body text-center">
        <img src="{{ customer.photo.url }}" alt="photo" class="img-fluid rounded">
      </div>
    </div>
  </div>
</div>
<br>
<h4>ğŸ“˜ æ´»å‹•ç´€éŒ„</h4>
<a href="{% url 'add_activity' customer.id %}" class="btn btn-outline-primary btn-sm mb-2">â• æ–°å¢ç´€éŒ„</a>

{% for act in customer.activities.all %}
  <div class="card mb-2">
    <div class="card-body">
      <p><strong>{{ act.get_type_display }} ï½œ {{ act.date }}</strong></p>
      <p>{{ act.content|linebreaks }}</p>

    {% if request.user == act.created_by or request.user.is_superuser %}
  <a href="{% url 'edit_activity' act.id %}" class="btn btn-sm btn-outline-secondary">âœï¸ ç·¨è¼¯</a>
  <a href="{% url 'delete_activity' act.id %}" class="btn btn-sm btn-danger"
     onclick="return confirm('ç¢ºå®šè¦åˆªé™¤é€™ç­†ç´€éŒ„å—ï¼Ÿ')">ğŸ—‘ï¸ åˆªé™¤</a>
{% endif %}
    </div>
  </div>
{% endfor %}
<h5>ğŸ§¼ å®¶ç”¨æ¸…æ½”è³¼è²·ç‹€æ³</h5>
<table class="table table-bordered w-auto">
  <tr>
    <th>ç”¢å“</th><th>ç‹€æ…‹</th>
  </tr>
  <tr>
    <td>æ¿ƒç¸®æ´—ç¢—ç²¾</td>
    <td>{{ customer.get_detergent_status_display }}</td>
  </tr>
  <tr>
    <td>L.O.C.</td>
    <td>{{ customer.get_loc_status_display }}</td>
  </tr>
  <tr>
    <td>SA8</td>
    <td>{{ customer.get_sa8_status_display }}</td>
  </tr>
</table>


{% endblock %}
